<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Welcome - Smart Digital Banking</title>
    <link rel="stylesheet" href="css/hdfc_style.css">
    <!-- Font Awesome for Icons -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>

<body>

    <!-- Navigation -->
    <nav class="landing-nav">
        <div class="nav-brand">
            <i class="fa-solid fa-building-columns" style="font-size: 28px; color: #fff;"></i>
            <span>SMART BANK</span>
        </div>
        <div class="nav-menu">
            <a href="#" class="nav-link">Personal Banking</a>
            <a href="#" class="nav-link">Corporate</a>
            <a href="#" class="nav-link">SME</a>
            <a href="about.html" class="nav-link">About Us</a>
            <!-- The button in the nav can just scroll to login or be a link -->
            <a href="#login-form" class="btn-login-nav">LOGIN</a>
        </div>
    </nav>

    <!-- Hero Section -->
    <div class="hero-section">

        <!-- Text Content -->
        <div class="hero-content">
            <h1 class="hero-title">Experience Banking<br>Differently</h1>
            <p class="hero-subtitle">Introducing the New Smart Bank App | NetBanking | Premium Support</p>

            <div class="hero-buttons">
                <a href="#" class="btn-hero">
                    <i class="fa-solid fa-mobile-screen"></i> Mobile App
                </a>
                <a href="#" class="btn-hero">
                    <i class="fa-solid fa-globe"></i> NetBanking
                </a>
            </div>
        </div>

        <!-- Login Card -->
        <div class="login-card-container">
            <div style="background-color: #e3f2fd; color: #0d47a1; padding: 10px; border-radius: 4px; margin-bottom: 15px; font-size: 14px; text-align: center; border: 1px solid #90caf9;">
                This web application build for automation testing
            </div>
            <div class="login-header">
                <h3>Login to NetBanking</h3>
            </div>

            <div id="login-alert" class="alert alert-danger"></div>

            <form id="login-form">
                <div class="form-group">
                    <label class="form-label">Customer ID / Username</label>
                    <input type="text" id="username" class="form-input" placeholder="Enter ID" required>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <input type="password" id="password" class="form-input" placeholder="Enter Password" required>
                </div>
                <button type="submit" class="btn-login-submit">LOGIN</button>
            </form>

            <div class="login-footer">
                <p>New to Smart Bank? <a href="register.html">Register Now</a></p>
                <p><a href="#">Forgot Password?</a></p>
            </div>
        </div>

    </div>

    <!-- Info Bar to fill white space -->
    <div class="info-bar">
        <div class="info-item">
            <i class="fa-solid fa-shield-halved"></i>
            <span>100% Secure Transaction</span>
        </div>
        <div class="info-item" onclick="openSupportModal()" style="cursor: pointer;">
            <i class="fa-solid fa-headset"></i>
            <span>24/7 Customer Support</span>
        </div>
        <div class="info-item">
            <i class="fa-solid fa-percent"></i>
            <span>Low Interest Loans</span>
        </div>
        <div class="info-item">
            <i class="fa-solid fa-credit-card"></i>
            <span>Reward Cards</span>
        </div>

    </div>

    <!-- Support Modal -->
    <div id="supportModal" class="modal">
        <div class="modal-content">
            <span class="close-btn" onclick="closeSupportModal()">&times;</span>
            <h2>Contact Support</h2>
            <p>Choose your preferred method:</p>
            <div class="modal-options">
                <a href="tel:+18001234567" class="modal-option-btn">
                    <i class="fa-solid fa-phone"></i>
                    <span>Call</span>
                </a>
                <a href="mailto:support@smartbank.com" class="modal-option-btn">
                    <i class="fa-solid fa-envelope"></i>
                    <span>Mail</span>
                </a>
                <a href="https://maps.google.com/?q=Smart+Bank" target="_blank" class="modal-option-btn">
                    <i class="fa-solid fa-location-dot"></i>
                    <span>Locate</span>
                </a>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script src="js/main.js"></script>
    <script>
        // Support Modal Logic
        const modal = document.getElementById("supportModal");
        function openSupportModal() {
            modal.style.display = "block";
        }
        function closeSupportModal() {
            modal.style.display = "none";
        }
        window.onclick = function (event) {
            if (event.target == modal) {
                modal.style.display = "none";
            }
        }

        // Redirect if already logged in (Auto-Login check)
        if (isLoggedIn()) {
            const user = JSON.parse(localStorage.getItem('user'));
            // Small delay to let animations play if we had them, OR instant redirect.
            // Instant redirect is better for UX.
            window.location.href = user.roles.includes('ROLE_ADMIN') ? 'admin.html' : 'dashboard.html';
        }

        // Login Logic
        document.getElementById('login-form').addEventListener('submit', async (e) => {
            e.preventDefault();
            const username = document.getElementById('username').value;
            const password = document.getElementById('password').value;
            const alertBox = document.getElementById('login-alert');

            // Basic UI indication
            const btn = e.target.querySelector('button');
            const originalText = btn.innerText;
            btn.innerText = 'Loggin In...';
            btn.disabled = true;

            try {
                const response = await fetch(API_URL + '/auth/signin', {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({ username, password })
                });

                const data = await response.json();

                if (response.ok) {
                    localStorage.setItem('token', data.token);
                    localStorage.setItem('user', JSON.stringify(data));

                    window.location.href = data.roles.includes('ROLE_ADMIN') ? 'admin.html' : 'dashboard.html';
                } else {
                    alertBox.innerText = 'Invalid username or password';
                    alertBox.style.display = 'block';
                    btn.innerText = originalText;
                    btn.disabled = false;
                }
            } catch (error) {
                alertBox.innerText = 'Server error. Please check connection.';
                alertBox.style.display = 'block';
                btn.innerText = originalText;
                btn.disabled = false;
            }
        });
    </script>

</body>

</html>